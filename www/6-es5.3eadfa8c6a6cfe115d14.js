(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{Wrxl:function(n,l,t){"use strict";t.r(l);var u=t("CcnG"),e=t("mrSG"),o=t("jHPu"),i=t("ZZ/e"),r=t("YCZo"),a=t("psW0"),s=function(){function n(n,l,t,u,e,o){this.chatSrv=n,this.alert=l,this.router=t,this.toast=u,this.afm=e,this.fcm=o,this.currentUser="Claudia"}return n.prototype.ngOnInit=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(n){return localStorage.getItem("token")?(this.chatSrv.registerDb(),this.obtenerConversacion()):this.obtenerConversacion(),this.fcm.onNotification().subscribe((function(n){console.log("data e onNotification:",n),n.wasTapped?console.log("tapped"):console.log("tap")})),[2]}))}))},n.prototype.makeToast=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(n){switch(n.label){case 0:return[4,this.toast.create({message:"has habilitado las notificaciones de tu coach",duration:5e3,position:"top",showCloseButton:!0,closeButtonText:"Entiendo"})];case 1:return n.sent().present(),[2]}}))}))},n.prototype.requestPushNotificationsPermission=function(){var n=this,l=localStorage.getItem("uid");this.afm.requestToken.subscribe((function(t){n.makeToast(),console.log("Permission granted! Save to the server!",t),n.chatSrv.registerToken(t,l)}),(function(n){console.error(n)}))},n.prototype.deleteToken=function(){var n=this;this.afm.getToken.pipe(Object(a.a)((function(l){return n.afm.deleteToken(l)}))).subscribe((function(n){console.log("Deleted!")}))},n.prototype.listen=function(){console.log("escuchando"),this.afm.messages.subscribe((function(n){console.log("m",n)}))},n.prototype.obtenerConversacion=function(){var n=this;console.log(this.conversacion);var l=localStorage.getItem("uid");this.chatSrv.getChatRoom(l).subscribe((function(l){n.conversacion=l,console.log("this.conversacion:",n.conversacion)})),setTimeout((function(){n.content.scrollToBottom(300)}),300)},n.prototype.sendMessage=function(){var n=this,l={content:this.msg,type:"text",date:new Date,user:localStorage.getItem("name")},t=localStorage.getItem("uid");this.chatSrv.sendMessageToFirebase(l,t),this.msg="",setTimeout((function(){n.content.scrollToBottom(300)}),500)},n}(),c=function(){return function(){}}(),b=t("pMnS"),g=t("oBZk"),f=t("Ip0R"),p=t("gIcY"),m=t("ZYCi"),d=t("BuFI"),h=u.sb({encapsulation:0,styles:[["ion-content[_ngcontent-%COMP%]   #areaMensajes[_ngcontent-%COMP%]{background:#f3f3f3!important;min-height:85vh;height:auto}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{background:#fff!important}.message[_ngcontent-%COMP%]{padding:10px;border-radius:10px;margin-bottom:4px;white-space:pre-wrap}.other-message[_ngcontent-%COMP%]{background:#ffc839;color:#fff}.my-message[_ngcontent-%COMP%]{background:#26baf5;color:#fff}.time[_ngcontent-%COMP%]{color:#ebe9e9;float:right;font-size:small}.msg-btn[_ngcontent-%COMP%]{--padding-start:0.5em;--padding-end:0.5em;font-size:1em}.message-input[_ngcontent-%COMP%]{height:40px;width:100%;border:1px solid var(--ion-color-medium);border-radius:10px;background:#fff;resize:none;padding-left:10px;padding-right:10px}#positionFixed[_ngcontent-%COMP%]{position:fixed!important;left:67%}.mamas[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-align:center}ion-footer[_ngcontent-%COMP%]{margin:0;padding:0 0 5px}ion-footer[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{border-bottom:none}.proximamente[_ngcontent-%COMP%]{text-align:center;font-size:1.4em}"]],data:{}});function v(n){return u.Pb(0,[(n()(),u.ub(0,0,null,null,10,"ion-col",[["class","message other-message"],["size","8"]],null,null,null,g.Y,g.j)),u.tb(1,49152,null,0,i.v,[u.h,u.k,u.A],{size:[0,"size"]},null),(n()(),u.ub(2,0,null,0,1,"b",[],null,null,null,null,null)),(n()(),u.Nb(3,null,["",""])),(n()(),u.ub(4,0,null,0,0,"br",[],null,null,null,null,null)),(n()(),u.ub(5,0,null,0,1,"span",[],null,null,null,null,null)),(n()(),u.Nb(6,null,["",""])),(n()(),u.ub(7,0,null,0,3,"div",[["class","time"],["text-right",""]],null,null,null,null,null)),u.tb(8,16384,null,0,i.e,[u.k],null,null),(n()(),u.Nb(9,null,[" "," "])),u.Jb(10,2)],(function(n,l){n(l,1,0,"8")}),(function(n,l){n(l,3,0,l.parent.context.$implicit.user),n(l,6,0,l.parent.context.$implicit.content);var t=u.Ob(l,9,0,n(l,10,0,u.Gb(l.parent.parent.parent,0),l.parent.context.$implicit.date.toDate(),"short"));n(l,9,0,t)}))}function k(n){return u.Pb(0,[(n()(),u.ub(0,0,null,null,10,"ion-col",[["class","message my-message"],["offset","4"],["size","8"]],null,null,null,g.Y,g.j)),u.tb(1,49152,null,0,i.v,[u.h,u.k,u.A],{offset:[0,"offset"],size:[1,"size"]},null),(n()(),u.ub(2,0,null,0,1,"b",[],null,null,null,null,null)),(n()(),u.Nb(3,null,["",""])),(n()(),u.ub(4,0,null,0,0,"br",[],null,null,null,null,null)),(n()(),u.ub(5,0,null,0,1,"span",[],null,null,null,null,null)),(n()(),u.Nb(6,null,["",""])),(n()(),u.ub(7,0,null,0,3,"div",[["class","time"],["text-right",""]],null,null,null,null,null)),u.tb(8,16384,null,0,i.e,[u.k],null,null),(n()(),u.Nb(9,null,[" "," "])),u.Jb(10,2)],(function(n,l){n(l,1,0,"4","8")}),(function(n,l){n(l,3,0,l.parent.context.$implicit.user),n(l,6,0,l.parent.context.$implicit.content);var t=u.Ob(l,9,0,n(l,10,0,u.Gb(l.parent.parent.parent,0),l.parent.context.$implicit.date.toDate(),"short"));n(l,9,0,t)}))}function C(n){return u.Pb(0,[(n()(),u.ub(0,0,null,null,5,"ion-row",[],null,null,null,g.qb,g.B)),u.tb(1,49152,null,0,i.lb,[u.h,u.k,u.A],null,null),(n()(),u.kb(16777216,null,0,1,null,v)),u.tb(3,16384,null,0,f.m,[u.Q,u.N],{ngIf:[0,"ngIf"]},null),(n()(),u.kb(16777216,null,0,1,null,k)),u.tb(5,16384,null,0,f.m,[u.Q,u.N],{ngIf:[0,"ngIf"]},null)],(function(n,l){var t=l.component;n(l,3,0,t.currentUser===l.context.$implicit.user),n(l,5,0,l.context.$implicit.user!==t.currentUser)}),null)}function x(n){return u.Pb(0,[(n()(),u.ub(0,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),u.kb(16777216,null,null,1,null,C)),u.tb(2,278528,null,0,f.l,[u.Q,u.N,u.t],{ngForOf:[0,"ngForOf"]},null)],(function(n,l){n(l,2,0,l.component.conversacion.messages)}),null)}function P(n){return u.Pb(0,[u.Hb(0,f.d,[u.v]),u.Lb(671088640,1,{content:0}),(n()(),u.ub(2,0,null,null,10,"ion-header",[],null,null,null,g.fb,g.q)),u.tb(3,49152,null,0,i.D,[u.h,u.k,u.A],null,null),(n()(),u.ub(4,0,null,0,8,"ion-toolbar",[["color","rosado"]],null,null,null,g.Db,g.O)),u.tb(5,49152,null,0,i.Eb,[u.h,u.k,u.A],{color:[0,"color"]},null),(n()(),u.ub(6,0,null,0,3,"ion-buttons",[["slot","start"]],null,null,null,g.T,g.e)),u.tb(7,49152,null,0,i.n,[u.h,u.k,u.A],null,null),(n()(),u.ub(8,0,null,0,1,"ion-menu-button",[],null,null,null,g.lb,g.x)),u.tb(9,49152,null,0,i.T,[u.h,u.k,u.A],null,null),(n()(),u.ub(10,0,null,0,2,"ion-title",[],null,null,null,g.Cb,g.N)),u.tb(11,49152,null,0,i.Cb,[u.h,u.k,u.A],null,null),(n()(),u.Nb(-1,0,["chat"])),(n()(),u.ub(13,0,null,null,10,"ion-content",[["padding",""]],null,null,null,g.Z,g.k)),u.tb(14,49152,[[1,4]],0,i.w,[u.h,u.k,u.A],null,null),u.tb(15,16384,null,0,i.e,[u.k],null,null),(n()(),u.kb(16777216,null,0,1,null,x)),u.tb(17,16384,null,0,f.m,[u.Q,u.N],{ngIf:[0,"ngIf"]},null),(n()(),u.ub(18,0,null,0,1,"button",[],null,[[null,"click"]],(function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.requestPushNotificationsPermission()&&u),u}),null,null)),(n()(),u.Nb(-1,null,[" Enable notifications! "])),(n()(),u.ub(20,0,null,0,1,"button",[],null,[[null,"click"]],(function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.deleteToken()&&u),u}),null,null)),(n()(),u.Nb(-1,null,[" Delete my token plz "])),(n()(),u.ub(22,0,null,0,1,"button",[],null,[[null,"click"]],(function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.listen()&&u),u}),null,null)),(n()(),u.Nb(-1,null,[" Get notified! "])),(n()(),u.ub(24,0,null,null,15,"ion-footer",[["padding",""]],null,null,null,g.db,g.o)),u.tb(25,49152,null,0,i.B,[u.h,u.k,u.A],null,null),u.tb(26,16384,null,0,i.e,[u.k],null,null),(n()(),u.ub(27,0,null,0,12,"ion-item",[],null,null,null,g.ib,g.t)),u.tb(28,49152,null,0,i.J,[u.h,u.k,u.A],null,null),(n()(),u.ub(29,0,null,0,6,"ion-textarea",[["autosize",""],["class","message-input"],["value","ingresa tu mensaje"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],(function(n,l,t){var e=!0,o=n.component;return"ionBlur"===l&&(e=!1!==u.Gb(n,30)._handleBlurEvent(t.target)&&e),"ionChange"===l&&(e=!1!==u.Gb(n,30)._handleInputEvent(t.target)&&e),"ngModelChange"===l&&(e=!1!==(o.msg=t)&&e),e}),g.Bb,g.M)),u.tb(30,16384,null,0,i.Sb,[u.k],null,null),u.Kb(1024,null,p.i,(function(n){return[n]}),[i.Sb]),u.tb(32,671744,null,0,p.n,[[8,null],[8,null],[8,null],[6,p.i]],{model:[0,"model"]},{update:"ngModelChange"}),u.Kb(2048,null,p.j,null,[p.n]),u.tb(34,16384,null,0,p.k,[[4,p.j]],null,null),u.tb(35,49152,null,0,i.Ab,[u.h,u.k,u.A],{value:[0,"value"]},null),(n()(),u.ub(36,0,null,0,3,"ion-button",[["class","msg-btn"],["color","primary"],["expand","block"],["fill","clear"]],null,[[null,"click"]],(function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.sendMessage()&&u),u}),g.S,g.d)),u.tb(37,49152,null,0,i.m,[u.h,u.k,u.A],{color:[0,"color"],expand:[1,"expand"],fill:[2,"fill"]},null),(n()(),u.ub(38,0,null,0,1,"ion-icon",[["name","send"]],null,null,null,g.gb,g.r)),u.tb(39,49152,null,0,i.E,[u.h,u.k,u.A],{name:[0,"name"]},null)],(function(n,l){var t=l.component;n(l,5,0,"rosado"),n(l,17,0,t.conversacion),n(l,32,0,t.msg),n(l,35,0,"ingresa tu mensaje"),n(l,37,0,"primary","block","clear"),n(l,39,0,"send")}),(function(n,l){n(l,29,0,u.Gb(l,34).ngClassUntouched,u.Gb(l,34).ngClassTouched,u.Gb(l,34).ngClassPristine,u.Gb(l,34).ngClassDirty,u.Gb(l,34).ngClassValid,u.Gb(l,34).ngClassInvalid,u.Gb(l,34).ngClassPending)}))}function M(n){return u.Pb(0,[(n()(),u.ub(0,0,null,null,1,"app-chat",[],null,null,null,P,h)),u.tb(1,114688,null,0,s,[o.a,i.a,m.m,i.Tb,d.a,r.a],null,null)],(function(n,l){n(l,1,0)}),null)}var _=u.qb("app-chat",s,M,{},{},[]);t.d(l,"ChatPageModuleNgFactory",(function(){return O}));var O=u.rb(c,[],(function(n){return u.Db([u.Eb(512,u.j,u.db,[[8,[b.a,_]],[3,u.j],u.y]),u.Eb(4608,f.o,f.n,[u.v,[2,f.E]]),u.Eb(4608,p.s,p.s,[]),u.Eb(4608,i.b,i.b,[u.A,u.g]),u.Eb(4608,i.Kb,i.Kb,[i.b,u.j,u.r]),u.Eb(4608,i.Ob,i.Ob,[i.b,u.j,u.r]),u.Eb(1073742336,f.b,f.b,[]),u.Eb(1073742336,p.r,p.r,[]),u.Eb(1073742336,p.e,p.e,[]),u.Eb(1073742336,i.Gb,i.Gb,[]),u.Eb(1073742336,m.o,m.o,[[2,m.t],[2,m.m]]),u.Eb(1073742336,c,c,[]),u.Eb(1024,m.k,(function(){return[[{path:"",component:s}]]}),[])])}))}}]);